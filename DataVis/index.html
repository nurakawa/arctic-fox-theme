---
layout: home
title:  Calendar Heatmap - Google Mobility Data
---
<!DOCTYPE html>
<html lang="en">
  <body>
    <br>
    <p>Prototype for course "Data Visualization". Visualizing change in mobility in 2020 using Google Mobility Data. 
    Please select a country and a variable! </p>
    <!-- Select country 
    TODO: Filter by region == ""
    -->    
    <select id="country">
      <option value="./assets/2020_NZ_Region_Mobility_Report.csv">New Zealand</option>
      <option value="./assets/2020_NZ_Region_Mobility_Report.csv">Belgium</option>
      <option value="./assets/2020_LB_Region_Mobility_Report.csv">Lebanon</option>
      <option value="./assets/2020_FI_Region_Mobility_Report.csv">Finland</option>
    </select>

    <!-- Select Indicator -->   
    <select id="ddlViewBy">
      <option value="parks_percent_change_from_baseline">retail and recreation</option>
      <option value="parks_percent_change_from_baseline">parks</option>
      <option value="transit_stations_percent_change_from_baseline">transit stations</option>
      <option value="workplaces_percent_change_from_baseline">workplaces</option>
      <option value="residential_percent_change_from_baseline">residential</option>
    </select>

    <div id="calendar" style="width: 960px; height: 200px;"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.13.0/d3.min.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <script src="d3.calendar.js"></script>
    <script>
            
            d3.select("#ddlViewBy").on("change", function(d){
              selectedGroup = String(this.value);
              d3.select('#calendar .chart').remove();
              updateChart(selectedGroup, selectedCountry)
            })
              d3.select("#country").on("change", function(d){
              selectedCountry = this.value;
              d3.select('#calendar .chart').remove();
              updateChart(selectedGroup, selectedCountry)
            })

              
            //var e = document.getElementById("ddlViewBy");
            //var strUser = e.options[e.selectedIndex].text;
        function updateChart(selectedGroup, selectedCountry){
          //df =  "./assets/nz-mob.csv";
          df = selectedCountry;
          //d3.csv("./assets/nz-mob.csv", function(error, data) {
          d3.csv(df, function(error, data) {
            if (error) throw error;

            d3.timeFormatDefaultLocale({
                "decimal": ".",
                "thousands": ",",
                "grouping": [3],
                "currency": ["$", ""],
                "dateTime": "%a %b %e %X %Y",
                "date": "%m/%d/%Y",
                "time": "%H:%M:%S",
                "periods": ["AM", "PM"],
                "days": ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
                "shortDays": ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"],
                "months": ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"],
                "shortMonths": ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]
            });

            var chart = new Calendar(d3.select('#calendar'), data,{
                'datefield': 'date',
                'key' : selectedGroup,
                'year': 2020,
                'mondaystart': true,
            });
            
            });
            
        };

    </script>
    
    <!-- Underneath: barplot -->
</body>
</html>
